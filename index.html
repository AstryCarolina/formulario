<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="stylesheet" href="./css/formulario.css">
    <title>Autenticación</title>
</head>
<body>

  <header>
    <input type="checkbox" name="" id="toggler">
    <label for="toggler" class="fas fa-bars"></label>
    <a class="logo" href="./index.html"> <img src="./image/logo 80x80.png" alt=""></a>
        <nav class="navbar">
            <a href="#">Inicio</a>
            <a href="#">Ofertas</a>
            <a href="#">Nuestro menú</a>
            <a href="#">Haz tu pedido</a>
            <a href="#">Nosotros</a>
            <a href="#">Contáctanos</a>
            <a href="./index.html">Regístrate</a>
            <a href="./storage.html">Sube tu voucher</a>
        </nav>
    
    <div class="icons">
        <a href="#" class="fas fa-heart"></a>
        <a href="#" class="fas fa-shopping-cart"></a>
        <a href="#" class="fas fa-user"></a>
    </div>
</header>
    
    <h1>FORMULARIO</h1>

  <section class="registro">
    <div class="formulario">
      <form id="bloque1">
        <h3>RESGÍSTRATE:</h3>
        <br> 
        <p>Escribe tu Correo Electrónico</p>
        <br>
        <input type="email" name="" id="email"><br>
        <br>
        <br>
        <p>Escribe tu Contraseña</p> 
        <br>
        <input type="password" name="" id="pass"><br>
        <br>
        <br>
      
        <button id="ingresar">REGISTRARSE</button>
        <button id="limpiar" onclick="limpiar()">BORRAR</button>
      </form>
      <br>
      <br>
      <button id="google">INICIAR CON GOOGLE</button>
    </div>

    <div class="formulario">    
      <h3>INGRESAR:</h3>
      <br>

      <p>Escribe tu Correo Electrónico</p>
      <br>
      <input type="email" name="" id="email5"><br>
      <br>
      <br>
      <p>Escribe tu Contraseña</p> 
      <br>
      <input type="password" name="" id="pass5"><br>
      <br>
      <br>
      <button id="ingresar5">ACEPTAR</button>
    </div>
  </section>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-auth.js";
        import { GoogleAuthProvider, signInWithRedirect, getRedirectResult } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-auth.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
    
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBhs2La-quBzeGsvoPvVscezE9jF86oWS0",
          authDomain: "usuario-6d3b5.firebaseapp.com",
          projectId: "usuario-6d3b5",
          storageBucket: "usuario-6d3b5.appspot.com",
          messagingSenderId: "956497881034",
          appId: "1:956497881034:web:f41c59a28ea30188c81133"
        };
    
        // Initialize Firebase y autenticación de google
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider(app);

        //Evento con el ID ingresar
        document.getElementById("ingresar").addEventListener("click",function(){
            const email = document.getElementById("email").value;
            const password = document.getElementById("pass").value;
        
            createUserWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
            // Signed in 
            const user = userCredential.user;
            // ...
            alert("La cuenta se creó exitosamente.")
            })
          .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            // ..
            alert("Tu cuenta ya ha sido creada.")
          });
        })

        document.getElementById("ingresar5").addEventListener("click", function(){
          const email1 = document.getElementById("email5"). value;  
          const password1 = document.getElementById("pass5"). value;
        
          signInWithEmailAndPassword(auth, email1, password1)
          .then((userCredential) => {
            // Signed in 
            const user = userCredential.user;
            // ...
            alert("Bienvenido")
          // ABRIREMOS UNA NUEVA PAGINA NUEVA
            //window.open("https://www.facebook.com")
          })

          window.open("./prueba.html")
          .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            alert("No has llenado correctamente tus datos o no estás registrado")
          });
        })

  // Crear la función para limpiar el contenido de los datos ingresados
  function limpiar(){
    document.getElementById("bloque1").reset();
  }

  document.getElementById("google").addEventListener("click",function(){
    signInWithRedirect(auth, provider);
  })

  getRedirectResult(auth)
  .then((result) => {
    // This gives you a Google Access Token. You can use it to access Google APIs.
    const credential = GoogleAuthProvider.credentialFromResult(result);
    const token = credential.accessToken;

    // The signed-in user info.
    const user = result.user;
    window.open("./prueba.html")
  }).catch((error) => {
    // Handle Errors here.
    const errorCode = error.code;
    const errorMessage = error.message;
    // The email of the user's account used.
    const email = error.customData.email;
    // The AuthCredential type that was used.
    const credential = GoogleAuthProvider.credentialFromError(error);
    // ...
  });
  
    </script>


    <footer>
      <section class="footer">
          <div class="box-container">
              <div class="box">
                  <h3>Frutal Fresh</h3>
                  <p>Nuestra familia Fruit Fresh, nació en el año 2017 para llevar a cada uno de los usuarios, la mejor experiencia que puedan imaginar.</p>
              </div>
  
              <div class="box">
                  <h3>Enlaces</h3>
                  <a href="#">Inicio</a>
                  <a href="#">Categorías</a>
                  <a href="#">Ofertas</a>
                  <a href="#">Delivery</a>
              </div>
  
              <div class="box">
                  <h3>Mi cuenta</h3>
                  <a href="#">Mi cuenta</a>
                  <a href="#">Mis pedidos</a>
                  <a href="#">Favoritos</a>
              </div>
  
              <div class="box">
                  <h3>Contáctanos</h3>
                  <p>El Parque 125 (La Planicie) Referencia: A una cuadra de la Universidad César Vallejo.</p>
                  <br>
                  <p>Teléfono: (01) 2738599</p>
                  <br>
              </div>
          </div>
      </section>
  </footer>
</body>
</html>